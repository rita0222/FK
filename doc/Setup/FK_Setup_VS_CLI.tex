\documentclass[a4j]{jarticle}

\textwidth=480pt
\textheight=680pt
\topmargin=0pt
\headheight=0pt
\headsep=3pt
\oddsidemargin=-20pt
\evensidemargin=-20pt

\begin{document}
\begin{center}
{\Large Fine Kernel ToolKit システム (Visual Studio CLI 版) \\
	セットアップマニュアル} \\ ~ \\
{\Large FineKernel Project} \\
(2015 年 9/15 版)
\end{center}


\section{Visual Studio のバージョンについて}
Fine Kernel ToolKit システム(以下 FK)は 
C\# や F\# などの .NET Framework 対応言語から利用可能な CLI バージョンを提供している。
現在は Visual Studio(以下 VS) 2013 と 2015 をサポートしている。

\section{FK システムのセットアップ}
VS のインストールが完了したら、FK のセットアップを以下の手順で行う。

\begin{enumerate}
\item 以下の URL から、FK ToolKit VisualStudio 用インストーラの項目にある
ファイルをダウンロードする。

\begin{verbatim}
    http://osdn.jp/projects/fktoolkit/releases/
\end{verbatim}

「FK\_CLI」から始まるファイル名が CLI 版のインストーラである。
2013 と 2015 でどちらも共通のインストーラを利用できる。

\item インストーラを起動し、指示に従ってインストールする。
標準の設定では ``\verb+C:\FK_CLI+'' という名称のフォルダにインストールされる。

セットアップ完了後に、OpenAL と Visual C++ 2013 再頒布パッケージのインストールが行われる。
OpenAL は CLI 版でサウンドをサポートしているため、インストールが必須である。
既にインストール済みの場合はスキップしても問題ないが、
多重にインストールしても問題ないものなので、確信が持てない場合はインストールすることを推奨する。
Visual C++ 2013 再頒布パッケージは、2015 だけがインストールされた環境で利用する場合に必要となる。
こちらも害があるものではないので、良く分からない場合はインストールしてしまってよい。

\end{enumerate}

\section{プロジェクトの作成方法}
VS では、アプリケーションを作成する際には「プロジェクト」を作成する必要がある。
開発には単なるプログラムソースだけでなく、
様々な開発用の設定ファイルが必要となるが、
プロジェクトはそれらを全て引っくるめたものだと考えれば良い。

FK の CLI 版を利用するには、プロジェクトの参照にインストールした DLL を指定する必要がある。
以下に例として、C\# で Windows フォームを利用したアプリケーションを作成する際の設定手順を述べる。
なお、文中の表記は 2015 を前提として説明しているので、2013 を利用している場合や、
VS の設定状況によっては若干操作や表記が異なる場合がある。

\begin{enumerate}
 \item VS を起動し、メニューから「ファイル」→「新規作成」→「プロジェクト」を選択する。
 \item 表示されたダイアログのうち、左側のツリーメニューから「Visual C\#」→「Windows」ツリーを選択する。
 \item 右側の「テンプレート」から「Windows フォーム アプリケーション」を選択する。
 \item 「プロジェクト名」というテキストボックス中に適当なプロジェクト名を入力する。
 \item 「場所」に適当な場所を設定しておく。この場所にプロジェクトのフォルダを配置し、
	プログラムソースを保管することになるので、きちんと場所を把握しておく必要がある。
 \item 上記の全ての入力を終えたら「OK」を押す。
 \item 作成したプロジェクトが開いたら、メニューの「プロジェクト」→「参照の追加」を選択する。
 \item 表示されたダイアログの下部にある「参照」ボタンを押し、
 	ファイル選択ダイアログで FK のインストール先を開き、Release フォルダ内にある
 	``\verb+FK_CLI.dll+'' と ``\verb+FK_FormHelper.dll+'' を選択して「OK」を押す。
\end{enumerate}

この手順で、プロジェクトの作成と設定が完了する。実際にはプロジェクト自体に加えて、
その上位に位置する「ソリューション」と呼ばれるファイルも同時に作成される。
VS で作成したプロジェクトを開く場合は、ソリューションを通じて行う。

ここではフォームアプリケーションを例にあげたが、
WPF を利用したい場合は「WPF アプリケーション」を、フォームも WPF も利用せず、
FK が提供するウィンドウを利用する場合は「コンソールアプリケーション」を選択すればよい。


\section{コンパイル(ビルド)}
ソースファイルが作成できたらコンパイルを行い、実行ファイル(exe)を生成する。
VS においては、コンパイルを初めとした一連の作業のことを「ビルド」と呼ぶ。
ビルドを行うには、メニュー中の「ビルド」→「ソリューションのビルド」を選択する。

エラーが発生した場合はメッセージを確認し、ソースファイルにおけるエラーの場合は
それを修正する必要がある。「参照が解決できない」などのエラーメッセージの場合は、
これまでの設定に何らかの不備がある可能性が高いので、もう一度これまでの手順を確認すること。


\section{実行}
ビルドが正常に終了した場合、プロジェクトファイルと同じフォルダ内にある 
bin フォルダ中に実行ファイルが生成される。
実行するには、メニューの「デバッグ」→「デバッグなしで開始」を選択する。

\subsection{ファイル読み込み処理を行うプログラムを実行する場合}
プログラム上から画像や形状データなどを読み込むプログラムを作成した場合、
カレントフォルダはプロジェクトファイルの存在しているフォルダになるため、
パスの設定に注意が必要である。
fk\_System::setcwd()関数をプログラム中で使用すると、カレントフォルダを
exeファイルと同じフォルダに変更することができるので、main()関数の冒頭で
コールしておくと便利である。詳細はクラスリファレンスを参照すること。


\section{プロジェクトの保存とロード}
プロジェクト全体の状態を保存するには、メニューの「ファイル」→「すべてを保存」を
実行する。これにより、全てのソースファイルとプロジェクトの情報が保存される。

保存したプロジェクトをロードするには、``.sln''を拡張子に持つファイルを開くか、
VS を起動後メニュー中の「ファイル」→ 「ソリューションを開く」を選択し、
``.sln''を拡張子に持つファイルを選択すればよい。


\end{document}
